<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
    <title>one Makefile for everything · savolla&#39;s blog</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="https://savolla.github.io/style.main.min.5ea2f07be7e07e221a7112a3095b89d049b96c48b831f16f1015bf2d95d914e5.css" />

</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
            <a class="site-nav-logo" href="https://savolla.github.io">savolla&#39;s blog</a>
        
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="about">about</a></li>
                
                <li class="nav-home" role="menuitem"><a href="posts">posts</a></li>
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post  no-image ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/tools">tools</a>
                    </section>
                

                <h1 class="post-full-title">one Makefile for everything</h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>[savolla]</h2>
                </div>
            </div>
        </div>
        <a href="#" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">[savolla]</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="0001-121-01">1 January 0001</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 1 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            

            <section class="post-full-content">
                <div class="post-content">
                    <p>here! you found it! this is one single Makefile that fits all projects with this file structure:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">project /
├── include
├── build
├── lib
├── obj
├── src
├── test
├── main.c
└── Makefile
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-makefile" data-lang="makefile"><span class="nv">TARGET_EXEC</span> <span class="o">?=</span> a.out

<span class="nv">BUILD_DIR</span> <span class="o">?=</span> ./build
<span class="nv">SRC_DIRS</span> <span class="o">?=</span> ./src

<span class="nv">SRCS</span> <span class="o">:=</span> <span class="k">$(</span>shell find <span class="k">$(</span>SRC_DIRS<span class="k">)</span> -name *.cpp -or -name *.c -or -name *.s<span class="k">)</span>
<span class="nv">OBJS</span> <span class="o">:=</span> <span class="k">$(</span>SRCS:%<span class="o">=</span><span class="k">$(</span>BUILD_DIR<span class="k">)</span>/%.o<span class="k">)</span>
<span class="nv">DEPS</span> <span class="o">:=</span> <span class="k">$(</span>OBJS:.o<span class="o">=</span>.d<span class="k">)</span>

<span class="nv">INC_DIRS</span> <span class="o">:=</span> <span class="k">$(</span>shell find <span class="k">$(</span>SRC_DIRS<span class="k">)</span> -type d<span class="k">)</span>
<span class="nv">INC_FLAGS</span> <span class="o">:=</span> <span class="k">$(</span>addprefix -I,<span class="k">$(</span>INC_DIRS<span class="k">))</span>

<span class="nv">CPPFLAGS</span> <span class="o">?=</span> <span class="k">$(</span>INC_FLAGS<span class="k">)</span> -MMD -MP

<span class="nf">$(BUILD_DIR)/$(TARGET_EXEC)</span><span class="o">:</span> <span class="k">$(</span><span class="nv">OBJS</span><span class="k">)</span>
<span class="k">$(</span><span class="nv">CC</span><span class="k">)</span> <span class="k">$(</span><span class="nv">OBJS</span><span class="k">)</span> <span class="err">-o</span> <span class="k">$@</span> <span class="k">$(</span><span class="nv">LDFLAGS</span><span class="k">)</span>

<span class="c"># assembly
</span><span class="c"></span><span class="nf">$(BUILD_DIR)/%.s.o</span><span class="o">:</span> %.<span class="n">s</span>
<span class="k">$(</span><span class="nv">MKDIR_P</span><span class="k">)</span> <span class="k">$(</span><span class="nv">dir</span> <span class="k">$</span>@<span class="k">)</span>
<span class="k">$(</span><span class="nv">AS</span><span class="k">)</span> <span class="k">$(</span><span class="nv">ASFLAGS</span><span class="k">)</span> <span class="err">-c</span> <span class="k">$&lt;</span> <span class="err">-o</span> <span class="k">$@</span>

<span class="c"># c source
</span><span class="c"></span><span class="nf">$(BUILD_DIR)/%.c.o</span><span class="o">:</span> %.<span class="n">c</span>
<span class="k">$(</span><span class="nv">MKDIR_P</span><span class="k">)</span> <span class="k">$(</span><span class="nv">dir</span> <span class="k">$</span>@<span class="k">)</span>
<span class="k">$(</span><span class="nv">CC</span><span class="k">)</span> <span class="k">$(</span><span class="nv">CPPFLAGS</span><span class="k">)</span> <span class="k">$(</span><span class="nv">CFLAGS</span><span class="k">)</span> <span class="err">-c</span> <span class="k">$&lt;</span> <span class="err">-o</span> <span class="k">$@</span>

<span class="c"># c++ source
</span><span class="c"></span><span class="nf">$(BUILD_DIR)/%.cpp.o</span><span class="o">:</span> %.<span class="n">cpp</span>
<span class="k">$(</span><span class="nv">MKDIR_P</span><span class="k">)</span> <span class="k">$(</span><span class="nv">dir</span> <span class="k">$</span>@<span class="k">)</span>
<span class="k">$(</span><span class="nv">CXX</span><span class="k">)</span> <span class="k">$(</span><span class="nv">CPPFLAGS</span><span class="k">)</span> <span class="k">$(</span><span class="nv">CXXFLAGS</span><span class="k">)</span> <span class="err">-c</span> <span class="k">$&lt;</span> <span class="err">-o</span> <span class="k">$@</span>


<span class="nf">.PHONY</span><span class="o">:</span> <span class="n">clean</span>

<span class="nf">clean</span><span class="o">:</span>
<span class="k">$(</span><span class="nv">RM</span><span class="k">)</span> <span class="err">-r</span> <span class="k">$(</span><span class="nv">BUILD_DIR</span><span class="k">)</span>

<span class="err">-include</span> <span class="k">$(</span><span class="nv">DEPS</span><span class="k">)</span>

<span class="nv">MKDIR_P</span> <span class="o">?=</span> mkdir -p
</code></pre></td></tr></table>
</div>
</div>
                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/tools">tools</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>
<article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="https://savolla.github.io/posts/permanent-macros-in-vim/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">vim</div>
                    

                    <h2 class="post-card-title">permanent macros in vim</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>this is a short step by step tutorial to save your vim macro and use it everytime
 fire up vim do q a create your macro press q to finish exit vim :q! vim ~/.vimrc type let @q = '' put your cursor on first single quote do &quot; a p macro should be pasted inside single quotes like:   1  let @q = &#39;your_macro_content&#39;    save and exit ESC :wq fire up vim again do @ q  now you should have your macro saved.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">[savolla]</div>
                            <a href="https://test.com" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>[savolla]</span>
                        <span class="post-card-byline-date"><time datetime="0001-121-01">1 January 0001</time>
                            <span class="bull">&bull;</span> 1 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    

            <article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="https://savolla.github.io/posts/less-known-vim-tricks/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">vim</div>
                    

                    <h2 class="post-card-title">less known vim tricks</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>ourput redirection  you can redirect outputs of a shell command in vim  press ESC :r !ls -la RET    whitespace removal  remove all trailing whitespaces. you can also make the following a permanent macro  press ESC :%s/\s\+$//e RET    time travel  show the file 10 mins ago  press ESC :earlier 10m RET   show the file after 10 mins  press ESC :later 10m RET    </p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">[savolla]</div>
                            <a href="https://test.com" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>[savolla]</span>
                        <span class="post-card-byline-date"><time datetime="0001-121-01">1 January 0001</time>
                            <span class="bull">&bull;</span> 1 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://savolla.github.io">savolla&#39;s blog</a> &copy; 0001</section>
                <nav class="site-footer-nav">
                    <a href="https://savolla.github.io">Latest Posts</a>
                    
                    
                    
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>

    </div>

</body>
</html>